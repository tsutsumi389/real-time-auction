# 入札者オークション詳細画面 実装計画

## 概要

### 目的
オークション開始前に、入札者がオークションの全体像と出品アイテムの詳細情報を確認できるプレビュー画面を提供する。この画面により、入札者は事前に商品情報を十分に把握し、オークション開始時に備えることができる。

### 対象ユーザー
- **入札者（bidder）**: オークションに参加予定のユーザー
- **一般訪問者**: 認証不要で閲覧可能（将来的な参加を検討するユーザー）

### 主要機能
1. **オークション概要表示**: タイトル、説明、ステータス、開始予定時刻
2. **出品アイテム一覧表示**: サムネイル画像付きカードグリッド形式
3. **アイテム詳細モーダル**: カードクリックで開く詳細情報表示
4. **メディアギャラリー**: 複数画像・動画の表示とナビゲーション
5. **静的情報表示**: リアルタイム更新なし、入札機能なし

### 既存システムとの関係
- **BidderAuctionListView.vue**: オークション一覧画面から「詳細を見る」ボタンで遷移
- **BidderAuctionLive.vue**: オークション開始後はライブ入札画面に遷移
- **既存API活用**: `GET /api/auctions/:id` エンドポイントを使用（新規API開発不要）

---

## 画面レイアウト

### 全体構成
```
┌─────────────────────────────────────────────────────────────┐
│ ナビゲーションヘッダー                                        │
│ [← 一覧に戻る]                               [ライブ入札へ]  │
├─────────────────────────────────────────────────────────────┤
│                                                               │
│  ┌─────────────────────────────────────────────────────┐   │
│  │ オークション概要セクション                            │   │
│  │                                                       │   │
│  │  タイトル: 第10回 競り市                              │   │
│  │  ステータスバッジ: [開催予定]                         │   │
│  │  開始予定: 2025年12月5日 14:00                       │   │
│  │                                                       │   │
│  │  説明文:                                              │   │
│  │  厳選された商品をご用意しました...                    │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                               │
│  ┌─────────────────────────────────────────────────────┐   │
│  │ 出品アイテム一覧 (12点)                               │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                               │
│  ┌──────────┐ ┌──────────┐ ┌──────────┐ ┌──────────┐     │
│  │ [画像]   │ │ [画像]   │ │ [画像]   │ │ [画像]   │     │
│  │          │ │          │ │          │ │          │     │
│  │ LOT 1    │ │ LOT 2    │ │ LOT 3    │ │ LOT 4    │     │
│  │ 商品名   │ │ 商品名   │ │ 商品名   │ │ 商品名   │     │
│  │ ¥100,000 │ │ ¥150,000 │ │ ¥200,000 │ │ ¥80,000  │     │
│  └──────────┘ └──────────┘ └──────────┘ └──────────┘     │
│                                                               │
│  ┌──────────┐ ┌──────────┐ ┌──────────┐ ┌──────────┐     │
│  │ LOT 5    │ │ LOT 6    │ │ LOT 7    │ │ LOT 8    │     │
│  └──────────┘ └──────────┘ └──────────┘ └──────────┘     │
│                                                               │
└─────────────────────────────────────────────────────────────┘
```

### アイテム詳細モーダル
```
┌─────────────────────────────────────────────────────────────┐
│                        ┌─────────────────────┐  [×]         │
│                        │                     │               │
│  ┌───────────────────┐│   メイン画像/動画   │┌──────────┐ │
│  │ サムネイル1       ││                     ││          │ │
│  │ サムネイル2       ││                     ││ LOT 3    │ │
│  │ サムネイル3 (選択)││     [ ← ]  [ → ]    ││          │ │
│  │ サムネイル4       ││                     ││ 商品名   │ │
│  │ サムネイル5       │└─────────────────────┘│          │ │
│  └───────────────────┘                        │ 開始価格 │ │
│                                                │ ¥200,000 │ │
│  ┌─────────────────────────────────────────┐ │          │ │
│  │ 商品説明                                 │ └──────────┘ │
│  │                                          │               │
│  │ この商品は...                            │               │
│  │                                          │               │
│  │ 【仕様】                                 │               │
│  │ - サイズ: ...                            │               │
│  │ - 年式: ...                              │               │
│  └─────────────────────────────────────────┘               │
│                                                               │
│                             [閉じる]                          │
└─────────────────────────────────────────────────────────────┘
```

### デザイン要件
- **カラースキーム**: Shadcn Vue のデフォルトテーマ（ライト/ダークモード対応）
- **フォント**: システムフォント（sans-serif）
- **スペーシング**: Tailwind CSS のスペーシングシステム（4px単位）
- **カードデザイン**: ホバー時に軽微なシャドウ効果、スムーズなトランジション
- **モーダル**: 背景オーバーレイ（半透明黒）、中央配置、アニメーション付き表示

### レスポンシブブレークポイント
- **モバイル (< 640px)**: 1カラム表示
- **タブレット (640px - 1024px)**: 2カラム表示
- **デスクトップ (> 1024px)**: 4カラム表示

---

## 入力項目とバリデーション

この画面は閲覧専用のため、ユーザー入力項目はなし。

---

## 処理フロー

### 画面初期表示フロー
```
[ユーザー]
   │
   │ 1. オークション一覧から「詳細を見る」クリック
   ↓
[BidderAuctionDetailView]
   │
   │ 2. ルートパラメータからオークションID取得
   ↓
[API呼び出し]
   │
   │ 3. GET /api/auctions/:id リクエスト
   ↓
[バックエンド]
   │
   │ 4. オークション情報 + 全アイテム + メディア情報を取得
   ↓
[レスポンス処理]
   │
   │ 5. データを画面に表示
   │    - オークション概要
   │    - アイテムカードグリッド
   ↓
[表示完了]
```

### アイテム詳細モーダル表示フロー
```
[ユーザー]
   │
   │ 1. アイテムカードをクリック
   ↓
[ItemDetailModal]
   │
   │ 2. 選択されたアイテムの詳細情報を表示
   │    - メディアギャラリー（複数画像/動画）
   │    - 商品名、LOT番号
   │    - 開始価格
   │    - 説明文（metadata.description）
   ↓
[ユーザー操作]
   │
   │ 3. 画像ナビゲーション（← → ボタン、サムネイルクリック）
   │ 4. 閉じるボタンまたは背景クリックでモーダル閉じる
   ↓
[モーダル閉鎖]
```

### エラーハンドリング
```
[エラー発生]
   │
   ├─ オークションが見つからない (404)
   │   └→ 「オークションが見つかりませんでした」メッセージ表示
   │      + 一覧に戻るボタン
   │
   ├─ ネットワークエラー
   │   └→ 「通信エラーが発生しました」メッセージ表示
   │      + 再読み込みボタン
   │
   └─ サーバーエラー (500)
       └→ 「サーバーエラーが発生しました」メッセージ表示
          + 再読み込みボタン
```

---

## セキュリティ要件

### データ保護
- **公開エンドポイント**: 認証不要でアクセス可能（`GET /api/auctions/:id`）
- **機密情報の非表示**: 入札者の個人情報、入札履歴は表示しない
- **価格情報**: 開始価格のみ表示（現在価格、入札履歴は非表示）

### XSS対策
- **HTMLエスケープ**: Vue.jsの標準テンプレートエンジンによる自動エスケープ
- **v-htmlの禁止**: ユーザー入力データを`v-html`で表示しない
- **メディアURL検証**: 画像/動画URLはバックエンドで検証済みのもののみ使用

### CSRF対策
- **GETリクエストのみ**: この画面ではデータ変更を行わないためCSRF対策不要

### 一般的な脆弱性対策
- **SQLインジェクション**: バックエンドでGORM（ORM）を使用し、プレースホルダーで防御
- **パストラバーサル**: UUIDによるオークションID指定で防御
- **情報漏洩**: エラーメッセージでシステム内部情報を露出しない

---

## データベース設計

### 使用する既存テーブル

#### auctionsテーブル
| カラム名 | データ型 | 制約 | 説明 |
|---------|---------|------|------|
| id | UUID | PRIMARY KEY | オークションID |
| title | VARCHAR(200) | NOT NULL | タイトル |
| description | TEXT | | 説明文 |
| status | VARCHAR(20) | NOT NULL | ステータス (pending/active/ended/cancelled) |
| started_at | TIMESTAMPTZ | | 開始日時 |
| created_at | TIMESTAMPTZ | NOT NULL | 作成日時 |
| updated_at | TIMESTAMPTZ | NOT NULL | 更新日時 |

#### itemsテーブル
| カラム名 | データ型 | 制約 | 説明 |
|---------|---------|------|------|
| id | UUID | PRIMARY KEY | アイテムID |
| auction_id | UUID | FOREIGN KEY | オークションID |
| name | VARCHAR(200) | NOT NULL | 商品名 |
| description | TEXT | | 説明文 |
| metadata | JSONB | | 拡張メタデータ |
| starting_price | BIGINT | NOT NULL | 開始価格 |
| current_price | BIGINT | | 現在価格 |
| winner_id | UUID | FOREIGN KEY | 落札者ID |
| lot_number | INT | NOT NULL | LOT番号 |
| started_at | TIMESTAMPTZ | | 開始日時 |
| ended_at | TIMESTAMPTZ | | 終了日時 |
| created_at | TIMESTAMPTZ | NOT NULL | 作成日時 |
| updated_at | TIMESTAMPTZ | NOT NULL | 更新日時 |

#### item_mediaテーブル
| カラム名 | データ型 | 制約 | 説明 |
|---------|---------|------|------|
| id | INT | PRIMARY KEY AUTO_INCREMENT | メディアID |
| item_id | UUID | FOREIGN KEY | アイテムID |
| media_type | VARCHAR(20) | NOT NULL | メディアタイプ (image/video) |
| url | VARCHAR(500) | NOT NULL | メディアURL |
| thumbnail_url | VARCHAR(500) | | サムネイルURL |
| display_order | INT | NOT NULL | 表示順序 |
| created_at | TIMESTAMPTZ | NOT NULL | 作成日時 |

### データ取得クエリの概要
- **オークション取得**: `SELECT * FROM auctions WHERE id = ?`
- **アイテム取得**: `SELECT * FROM items WHERE auction_id = ? ORDER BY lot_number`
- **メディア取得**: `SELECT * FROM item_media WHERE item_id IN (?) ORDER BY display_order`

**注**: バックエンドの`GetAuctionDetail`ハンドラーが既にこれらを1回のAPIコールで取得する実装済み。

---

## API仕様

### GET /api/auctions/:id

#### エンドポイント
- **URL**: `/api/auctions/:id`
- **メソッド**: GET
- **認証**: 不要（公開エンドポイント）

#### パスパラメータ
| パラメータ名 | 型 | 必須 | 説明 |
|------------|-----|------|------|
| id | UUID | ○ | オークションID |

#### リクエスト例
```
GET /api/auctions/550e8400-e29b-41d4-a716-446655440000
```

#### 成功レスポンス (200 OK)
```json
{
  "id": "550e8400-e29b-41d4-a716-446655440000",
  "title": "第10回 競り市",
  "description": "厳選された商品をご用意しました。多数のご参加をお待ちしております。",
  "status": "pending",
  "started_at": "2025-12-05T14:00:00+09:00",
  "created_at": "2025-11-20T10:00:00+09:00",
  "updated_at": "2025-11-25T15:30:00+09:00",
  "items": [
    {
      "id": "123e4567-e89b-12d3-a456-426614174000",
      "auction_id": "550e8400-e29b-41d4-a716-446655440000",
      "name": "高級腕時計",
      "description": "スイス製自動巻き腕時計。状態良好。",
      "metadata": {
        "brand": "ロレックス",
        "model": "サブマリーナ",
        "year": 2020
      },
      "starting_price": 1000000,
      "current_price": 1000000,
      "winner_id": null,
      "lot_number": 1,
      "started_at": null,
      "ended_at": null,
      "created_at": "2025-11-20T10:05:00+09:00",
      "updated_at": "2025-11-20T10:05:00+09:00",
      "status": "pending",
      "media": [
        {
          "id": 1,
          "item_id": "123e4567-e89b-12d3-a456-426614174000",
          "media_type": "image",
          "url": "https://example.com/media/watch1.jpg",
          "thumbnail_url": "https://example.com/media/watch1_thumb.jpg",
          "display_order": 0,
          "created_at": "2025-11-20T10:06:00+09:00"
        },
        {
          "id": 2,
          "item_id": "123e4567-e89b-12d3-a456-426614174000",
          "media_type": "image",
          "url": "https://example.com/media/watch2.jpg",
          "thumbnail_url": "https://example.com/media/watch2_thumb.jpg",
          "display_order": 1,
          "created_at": "2025-11-20T10:06:00+09:00"
        }
      ]
    },
    {
      "id": "223e4567-e89b-12d3-a456-426614174001",
      "name": "ヴィンテージカメラ",
      "starting_price": 500000,
      "lot_number": 2,
      "status": "pending",
      "media": [...]
    }
  ]
}
```

#### エラーレスポンス

**404 Not Found** - オークションが存在しない
```json
{
  "error": "オークションが見つかりませんでした"
}
```

**500 Internal Server Error** - サーバーエラー
```json
{
  "error": "サーバーエラーが発生しました"
}
```

---

## バックエンド実装要件

### 実装状況
**既に実装済み**: `GET /api/auctions/:id` エンドポイントは完全に実装済みのため、バックエンド側の追加実装は不要。

### 既存実装の概要

#### Handler層（auction_handler.go）
- **GetAuctionDetail**: オークションIDからオークション詳細とアイテム一覧を取得
- レスポンス形式: `GetAuctionDetailResponse` 構造体
- エラーハンドリング: 404, 500エラーに対応

#### Service層（auction_service.go）
- **GetAuctionDetailByID**: オークションとアイテムの取得ロジック
- アイテムのステータス計算（pending/active/ended）
- トランザクション管理

#### Repository層（auction_repository.go, item_repository.go）
- **FindAuctionByID**: オークション取得
- **FindItemsByAuctionID**: アイテム一覧取得（メディア含む）
- GORM（ORM）を使用したデータベースアクセス

#### Domain層（auction.go, item.go）
- **Auction**: オークションモデル
- **Item**: アイテムモデル
- **ItemMedia**: メディアモデル
- **GetAuctionDetailResponse**: APIレスポンス構造体

### 技術スタック
- **Go 1.21+**
- **Ginフレームワーク**: HTTPルーティング
- **GORM**: PostgreSQL ORM
- **PostgreSQL**: データベース

---

## フロントエンド実装要件

### ディレクトリ構成
```
frontend/src/
├── views/
│   └── BidderAuctionDetailView.vue       # 新規作成: メインビュー
├── components/
│   └── bidder/
│       ├── AuctionCard.vue               # 既存: 「詳細を見る」ボタン更新
│       ├── ItemCardGrid.vue              # 新規作成: アイテムカードグリッド
│       └── ItemDetailModal.vue           # 新規作成: アイテム詳細モーダル
├── router/
│   └── index.js                          # 更新: 新規ルート追加
└── services/
    └── bidderAuctionApi.js               # 既存: APIクライアント（既に実装済み）
```

### コンポーネント責務

#### BidderAuctionDetailView.vue（新規作成）
- **役割**: オークション詳細画面のメインコンポーネント
- **機能**:
  - ルートパラメータからオークションID取得
  - APIからオークション詳細データ取得
  - オークション概要表示（タイトル、説明、ステータス、開始日時）
  - ItemCardGridコンポーネントを使用してアイテム一覧表示
  - ItemDetailModalコンポーネントを管理
  - ローディング状態とエラー状態の管理
  - 「一覧に戻る」「ライブ入札へ」ナビゲーション
- **使用するShadcn Vueコンポーネント**:
  - Card（オークション概要表示）
  - Button（ナビゲーションボタン）
  - Alert（エラーメッセージ表示）
  - LoadingSpinner（ローディング表示）

#### ItemCardGrid.vue（新規作成）
- **役割**: アイテムをカードグリッド形式で表示
- **機能**:
  - アイテム配列を受け取り、グリッドレイアウトで表示
  - 各カード: サムネイル画像、LOT番号、商品名、開始価格
  - カードクリック時に親コンポーネントにイベント発火
  - レスポンシブグリッド（1/2/4カラム）
  - ホバーエフェクト
- **使用するShadcn Vueコンポーネント**:
  - Card（各アイテムカード）
  - Badge（LOT番号表示）

#### ItemDetailModal.vue（新規作成）
- **役割**: アイテムの詳細情報をモーダルで表示
- **機能**:
  - アイテムオブジェクトを受け取り、詳細情報を表示
  - メディアギャラリー（複数画像/動画）
  - 画像ナビゲーション（前へ/次へボタン、サムネイルクリック）
  - LOT番号、商品名、開始価格、説明文表示
  - モーダルの開閉管理
  - キーボードナビゲーション（Escキーで閉じる、矢印キーで画像切り替え）
- **使用するShadcn Vueコンポーネント**:
  - Dialog（モーダル本体）
  - Button（ナビゲーション、閉じるボタン）
  - Badge（LOT番号）

#### AuctionCard.vue（既存更新）
- **更新内容**: 「詳細を見る」ボタンのクリックハンドラーを更新
- **変更点**: `/auctions/:id` に遷移するよう修正

### 状態管理
- **コンポーネントローカル状態**: Vue 3 Composition APIの`ref`/`reactive`を使用
- **Pinia不使用**: この画面では複雑なグローバル状態管理は不要

### ルーティング設定
**router/index.js に追加**:
```javascript
{
  path: '/auctions/:id',
  name: 'BidderAuctionDetail',
  component: () => import('../views/BidderAuctionDetailView.vue'),
  meta: {
    requiresAuth: false,  // 認証不要
    title: 'オークション詳細'
  }
}
```

### 技術スタック
- **Vue 3**: Composition API (`<script setup>`)
- **Vue Router 4**: ルーティング
- **Shadcn Vue**: UIコンポーネントライブラリ
- **Tailwind CSS**: スタイリング
- **Axios**: HTTP通信（既存のAPIクライアント使用）

---

## 画面遷移

### 遷移フロー図
```
[オークション一覧]
  (BidderAuctionListView)
         │
         │ 1. 「詳細を見る」ボタンクリック
         │    router.push(`/auctions/${auctionId}`)
         ↓
[オークション詳細]
  (BidderAuctionDetailView)
         │
         ├─ 2a. 「一覧に戻る」ボタンクリック
         │      router.push('/auctions')
         │      └→ [オークション一覧]
         │
         └─ 2b. 「ライブ入札へ」ボタンクリック（ステータスがactiveの場合のみ表示）
                router.push(`/auctions/${auctionId}/live`)
                └→ [ライブ入札画面]
                    (BidderAuctionLive)
```

### ナビゲーションガード
- **認証チェック**: 不要（公開ページ）
- **存在チェック**: オークションIDが無効な場合は404エラーページ表示
- **ステータスチェック**: オークションが`active`の場合、「ライブ入札へ」ボタンを表示

### リダイレクトルール
- **オークションが見つからない**: エラーメッセージ表示 + 「一覧に戻る」ボタン
- **ネットワークエラー**: エラーメッセージ表示 + 「再読み込み」ボタン

---

## UIの動作仕様

### ユーザーインタラクション

#### 1. アイテムカードクリック
- **トリガー**: アイテムカードをクリック
- **動作**:
  - ItemDetailModalが開く
  - 選択されたアイテムの詳細情報を表示
  - モーダル背景にオーバーレイ表示
  - スムーズなフェードインアニメーション

#### 2. メディアギャラリーナビゲーション
- **前へ/次へボタン**:
  - 画像配列のインデックスを増減
  - 最初/最後の画像では対応するボタンを無効化
- **サムネイルクリック**:
  - クリックされたサムネイルの画像をメイン表示
  - 選択中のサムネイルに視覚的フィードバック（枠線、背景色）
- **キーボード操作**:
  - 左矢印キー: 前の画像
  - 右矢印キー: 次の画像
  - Escキー: モーダルを閉じる

#### 3. モーダルを閉じる
- **トリガー**:
  - 「閉じる」ボタンクリック
  - 背景オーバーレイクリック
  - Escキー押下
- **動作**:
  - スムーズなフェードアウトアニメーション
  - モーダル状態をリセット

#### 4. ナビゲーションボタン
- **「一覧に戻る」**: オークション一覧画面に遷移
- **「ライブ入札へ」**:
  - オークションステータスが`active`の場合のみ表示
  - ライブ入札画面に遷移

### ローディング状態
- **初期ロード**:
  - スケルトンスクリーン表示（オークション概要とアイテムカードの形状）
  - ローディングスピナー表示
- **ロード完了**:
  - フェードインアニメーションで実データ表示

### エラーフィードバック
- **オークション取得失敗**:
  - Alertコンポーネントでエラーメッセージ表示
  - 「再読み込み」ボタン表示
- **画像読み込み失敗**:
  - プレースホルダー画像表示
  - 「画像を読み込めませんでした」テキスト

### 成功フィードバック
- **データ取得成功**: スムーズにコンテンツを表示（トーストなし）

---

## レスポンシブデザイン

### モバイル (< 640px)
- **アイテムグリッド**: 1カラム
- **モーダル**: フルスクリーン表示
  - メディアギャラリーを縦配置
  - サムネイル一覧を横スクロール
- **オークション概要**: 縦配置
- **ナビゲーションボタン**: フルウィズ、縦スタック

### タブレット (640px - 1024px)
- **アイテムグリッド**: 2カラム
- **モーダル**: 画面の80%幅
  - メディアギャラリーと詳細情報を横並び
- **オークション概要**: 横配置（左: タイトル/説明、右: ステータス/日時）

### デスクトップ (> 1024px)
- **アイテムグリッド**: 4カラム
- **モーダル**: 最大幅1200px、中央配置
  - メディアギャラリーと詳細情報を横並び（7:3の比率）
- **オークション概要**: 横配置、十分な余白

### レイアウト調整
- **フォントサイズ**:
  - モバイル: 14px ベース
  - タブレット: 15px ベース
  - デスクトップ: 16px ベース
- **画像サイズ**:
  - サムネイル: レスポンシブ（カードの100%幅）
  - モーダルメイン画像: 最大高さ600px（デスクトップ）、400px（モバイル）
- **スペーシング**:
  - モバイル: コンパクト（padding: 4px, gap: 8px）
  - デスクトップ: ゆとり（padding: 6px, gap: 16px）

---

## アクセシビリティ

### キーボードナビゲーション
- **Tabキー**: フォーカス可能な要素間の移動
  - アイテムカード → ナビゲーションボタン → モーダル内要素
- **Enterキー**: フォーカス中の要素をアクティブ化
  - アイテムカードにフォーカス時: モーダルを開く
- **Escキー**: モーダルを閉じる
- **矢印キー**: メディアギャラリー内の画像ナビゲーション

### スクリーンリーダー対応
- **セマンティックHTML**:
  - `<main>`, `<article>`, `<section>`, `<nav>` 適切な使用
- **ARIA属性**:
  - `role="dialog"` on modal
  - `aria-label="オークション詳細"` on main section
  - `aria-labelledby` for modal title
  - `aria-describedby` for modal description
  - `aria-live="polite"` for error messages
- **代替テキスト**:
  - 全画像に`alt`属性を設定
  - 装飾画像は`alt=""`

### フォーカス管理
- **モーダルオープン時**:
  - フォーカスをモーダル内の最初の要素（閉じるボタン）に移動
  - 背景要素をフォーカス不可に設定（`inert`属性）
- **モーダルクローズ時**:
  - フォーカスを元の要素（クリックされたアイテムカード）に戻す

### カラーコントラスト
- **WCAG AA準拠**:
  - テキストと背景のコントラスト比 4.5:1以上
  - ボタンとリンクのコントラスト比 3:1以上
- **ステータスバッジ**: 色だけでなくテキストでも情報を伝える

### 動きの配慮
- **アニメーション**: `prefers-reduced-motion`メディアクエリに対応
  - ユーザーが動きを減らす設定の場合、アニメーションを無効化

---

## テスト要件

### 機能テストシナリオ

#### 1. オークション詳細表示
- **シナリオ**: 正常なオークションIDでアクセス
- **期待結果**:
  - オークション概要（タイトル、説明、ステータス、開始日時）が表示される
  - 全アイテムがカードグリッド形式で表示される
  - 各カードにサムネイル、LOT番号、商品名、開始価格が表示される

#### 2. アイテム詳細モーダル表示
- **シナリオ**: アイテムカードをクリック
- **期待結果**:
  - モーダルが開く
  - 選択されたアイテムの詳細情報が表示される
  - メディアギャラリーが機能する（画像切り替え、サムネイルクリック）

#### 3. メディアギャラリーナビゲーション
- **シナリオ**: モーダル内で前へ/次へボタンをクリック
- **期待結果**:
  - 画像が切り替わる
  - 最初/最後の画像では対応するボタンが無効化される
  - サムネイルの選択状態が更新される

#### 4. キーボード操作
- **シナリオ**: キーボードでモーダル操作
- **期待結果**:
  - Escキーでモーダルが閉じる
  - 左右矢印キーで画像が切り替わる
  - Tabキーでフォーカスが移動する

#### 5. エラーハンドリング
- **シナリオ**: 存在しないオークションIDでアクセス
- **期待結果**:
  - 404エラーメッセージが表示される
  - 「一覧に戻る」ボタンが表示される

#### 6. レスポンシブデザイン
- **シナリオ**: 異なる画面サイズで表示
- **期待結果**:
  - モバイル: 1カラム、フルスクリーンモーダル
  - タブレット: 2カラム
  - デスクトップ: 4カラム

#### 7. ナビゲーション
- **シナリオ**: 「一覧に戻る」ボタンをクリック
- **期待結果**: オークション一覧画面に遷移
- **シナリオ**: 「ライブ入札へ」ボタンをクリック（ステータスがactiveの場合）
- **期待結果**: ライブ入札画面に遷移

### エッジケース

#### 1. メディアなしのアイテム
- **シナリオ**: アイテムにメディアが登録されていない
- **期待結果**: プレースホルダー画像を表示

#### 2. 大量のアイテム
- **シナリオ**: 100件以上のアイテムを持つオークション
- **期待結果**:
  - スクロール可能なグリッド表示
  - パフォーマンス低下なし（仮想スクロール不要な場合）

#### 3. 長い説明文
- **シナリオ**: アイテム説明が非常に長い
- **期待結果**:
  - モーダル内でスクロール可能
  - レイアウトが崩れない

#### 4. 画像読み込み失敗
- **シナリオ**: 画像URLが無効
- **期待結果**:
  - プレースホルダー画像を表示
  - エラーメッセージを表示

### パフォーマンステスト
- **初期ロード時間**: 3秒以内（通常のネットワーク環境）
- **画像最適化**: 適切なサイズとフォーマット（WebP推奨）
- **バンドルサイズ**: コンポーネント単位で適切にコード分割

---

## 環境変数

### 必要な環境変数

#### VITE_API_BASE_URL
- **説明**: REST APIのベースURL
- **デフォルト値**: `http://localhost/api`
- **本番環境例**: `https://auction.example.com/api`
- **使用箇所**: Axiosクライアントの初期化

### 設定ファイル例

#### .env.development
```
VITE_API_BASE_URL=http://localhost/api
```

#### .env.production
```
VITE_API_BASE_URL=https://auction.example.com/api
```

---

## 実装手順

### フェーズ1: 基本構造の実装（所要時間: 2-3時間）
- [x] BidderAuctionDetailView.vueの作成
  - [x] 基本レイアウト構造の実装
  - [x] ルートパラメータからオークションID取得
  - [x] API呼び出しロジックの実装
  - [x] ローディング状態の実装
- [x] router/index.jsに新規ルート追加
- [x] AuctionCard.vueの「詳細を見る」ボタン更新

### フェーズ2: オークション概要表示（所要時間: 1-2時間）
- [x] オークション情報の表示実装
  - [x] タイトル、説明文の表示
  - [x] AuctionStatusBadgeコンポーネントの統合
  - [x] 開始日時のフォーマット表示
- [x] Shadcn Vue CardコンポーネントでのUI実装
- [x] レスポンシブデザインの適用

### フェーズ3: アイテムカードグリッドの実装（所要時間: 2-3時間）
- [x] ItemCardGrid.vueコンポーネントの作成
  - [x] グリッドレイアウトの実装（Tailwind Grid）
  - [x] アイテムカードの基本デザイン
  - [x] サムネイル画像の表示
  - [x] LOT番号、商品名、開始価格の表示
  - [x] ホバーエフェクトの実装
- [x] レスポンシブグリッド（1/2/4カラム）の実装
- [x] 画像読み込みエラー処理（プレースホルダー表示）

### フェーズ4: アイテム詳細モーダルの実装（所要時間: 3-4時間）
- [x] ItemDetailModal.vueコンポーネントの作成
  - [x] Shadcn Vue Dialogコンポーネントの統合
  - [x] モーダル開閉ロジックの実装
  - [x] アイテム詳細情報の表示
- [x] メディアギャラリーの実装
  - [x] メイン画像/動画の表示
  - [x] サムネイル一覧の表示
  - [x] 前へ/次へボタンのナビゲーション
  - [x] サムネイルクリックでの画像切り替え
- [x] キーボードナビゲーション（Esc、矢印キー）の実装
- [x] モーダルのレスポンシブデザイン

### フェーズ5: エラーハンドリングとユーザーフィードバック（所要時間: 1-2時間）
- [x] エラー状態の管理と表示
  - [x] 404エラー処理
  - [x] ネットワークエラー処理
  - [x] サーバーエラー処理
- [x] Shadcn Vue Alertコンポーネントでのエラー表示
- [x] 「再読み込み」ボタンの実装
- [x] ローディングスピナー/スケルトンスクリーンの改善

### フェーズ6: ナビゲーションとルーティング（所要時間: 1時間）
- [ ] 「一覧に戻る」ボタンの実装
- [ ] 「ライブ入札へ」ボタンの実装
  - [ ] ステータスによる表示/非表示制御
- [ ] ブラウザの戻るボタン対応

### フェーズ7: アクセシビリティ対応（所要時間: 2-3時間）
- [ ] セマンティックHTML構造の確認
- [ ] ARIA属性の追加
  - [ ] role, aria-label, aria-labelledby, aria-describedby
- [ ] キーボードナビゲーションのテストと改善
- [ ] フォーカス管理の実装
  - [ ] モーダルオープン/クローズ時のフォーカス制御
- [ ] スクリーンリーダーでのテスト
- [ ] カラーコントラストの確認
- [ ] prefers-reduced-motion対応

### フェーズ8: スタイリングとUIの洗練（所要時間: 2-3時間）
- [ ] Tailwind CSSでのデザイン調整
- [ ] アニメーションとトランジションの追加
  - [ ] モーダルのフェードイン/アウト
  - [ ] カードのホバーエフェクト
  - [ ] 画像切り替えのスムーズなトランジション
- [ ] ダークモード対応の確認
- [ ] フォントサイズとスペーシングの最適化

### フェーズ9: テストとデバッグ（所要時間: 3-4時間）
- [ ] 機能テスト
  - [ ] 全テストシナリオの実行
  - [ ] エッジケースの確認
- [ ] レスポンシブデザインのテスト
  - [ ] モバイル、タブレット、デスクトップでの表示確認
- [ ] ブラウザ互換性テスト
  - [ ] Chrome, Firefox, Safari, Edgeでの動作確認
- [ ] パフォーマンステスト
  - [ ] 初期ロード時間の測定
  - [ ] 大量アイテムでのパフォーマンス確認
- [ ] アクセシビリティテスト
  - [ ] キーボード操作の確認
  - [ ] スクリーンリーダーでの読み上げ確認

### フェーズ10: 最終確認とドキュメント更新（所要時間: 1時間）
- [ ] コードレビュー
- [ ] READMEやコメントの更新
- [ ] 不要なコンソールログの削除
- [ ] 本番環境への適用準備

**合計所要時間**: 約18-25時間

---

## 成功基準

### 機能要件
- [ ] オークション一覧から詳細画面に遷移できる
- [ ] オークション概要（タイトル、説明、ステータス、開始日時）が表示される
- [ ] 全アイテムがカードグリッド形式で表示される
- [ ] アイテムカードクリックでモーダルが開く
- [ ] モーダルでアイテムの詳細情報とメディアギャラリーが表示される
- [ ] メディアギャラリーで画像/動画のナビゲーションができる
- [ ] 「一覧に戻る」ボタンで一覧画面に戻れる
- [ ] オークションがactiveの場合「ライブ入札へ」ボタンが表示され、ライブ画面に遷移できる

### 非機能要件
- [ ] 初期ロード時間が3秒以内（通常のネットワーク環境）
- [ ] エラー発生時に適切なメッセージが表示される
- [ ] モバイル、タブレット、デスクトップで適切に表示される
- [ ] キーボードのみで全操作が可能
- [ ] スクリーンリーダーで内容が正しく読み上げられる
- [ ] WCAG AA準拠のアクセシビリティ基準を満たす

### UI/UX要件
- [ ] モダンで洗練されたデザイン（Shadcn Vue + Tailwind CSS）
- [ ] スムーズなアニメーションとトランジション
- [ ] 直感的で使いやすいナビゲーション
- [ ] 適切なローディング状態とエラーフィードバック

---

## 次のステップ

この実装が完了した後、以下の関連機能の実装を検討してください：

### 1. お気に入り機能
- オークションやアイテムをお気に入りに登録
- お気に入り一覧画面の実装
- お気に入り通知機能

### 2. 検索とフィルタリングの強化
- アイテム内検索機能
- 価格帯フィルター
- カテゴリーフィルター

### 3. ソーシャルシェア機能
- オークション詳細をSNSでシェア
- アイテムをシェア

### 4. オークションのプレビュー通知
- オークション開始前のリマインダー
- お気に入りオークションの開始通知

### 5. 類似オークション/アイテムの推薦
- 類似オークションの表示
- 関連アイテムの推薦

### 6. 詳細な統計情報
- オークションの参加者数
- アイテムの閲覧数

---

## 実装で修正が必要な重要ファイル

以下のファイルを実装時に修正します：

### 1. frontend/src/router/index.js（ルート追加）
- **行118-128**: 入札者向けルート定義セクション
- **追加内容**: `/auctions/:id` ルートを追加（BidderAuctionDetailViewコンポーネント）
- **配置**: 行122の後（`bidder-auction-list` ルートの直後）

### 2. frontend/src/components/bidder/AuctionCard.vue（ナビゲーション更新）
- **行117-119**: `handleViewDetails` 関数
- **変更内容**: `emit('view-details', props.auction)` から `router.push()` に変更
- **理由**: 親コンポーネントを経由せず直接ルーティングする方がシンプル

### 3. 新規作成ファイル
- **frontend/src/views/BidderAuctionDetailView.vue**: メインビュー（約300行）
- **frontend/src/components/bidder/ItemCardGrid.vue**: アイテムカードグリッド（約150行）
- **frontend/src/components/bidder/ItemDetailModal.vue**: アイテム詳細モーダル（約250行）

### 4. 既存コンポーネントの再利用
- **AuctionStatusBadge.vue**: ステータス表示バッジ（そのまま使用）
- **AuctionSearchBar.vue**: 検索バー（参考）
- **ProductImageGallery.vue**: 画像ギャラリー（参考として活用可能）

### バックエンド
- **修正不要**: `GET /api/auctions/:id` エンドポイントは既に完全実装済み
- **location**: backend/internal/handler/auction_handler.go（GetAuctionDetail関数）

---

## 実装上の注意事項

### パフォーマンス最適化
- 画像の遅延ロード（Lazy Loading）の検討
- 大量アイテムの場合の仮想スクロール検討
- 適切なバンドル分割

### セキュリティ
- XSS対策: ユーザー入力データのエスケープ
- 画像URLの検証

### コード品質
- Vue 3 Composition APIのベストプラクティスに従う
- コンポーネントの適切な分割
- 再利用可能なコンポーネントの設計
- TypeScriptの型定義（将来的に検討）

### ブラウザ互換性
- モダンブラウザ（Chrome, Firefox, Safari, Edge）のサポート
- IEは非サポート

---

以上が入札者オークション詳細画面の実装計画です。この計画に従って実装を進めることで、ユーザーフレンドリーでアクセシブルな、モダンなオークション詳細画面を構築できます。
