# システム管理者一覧画面（1.2.1）実装プラン

**作成日**: 2025年11月21日
**対象画面**: システム管理者一覧画面（Admin List）
**パス**: `/admin/admins`
**権限**: system_admin
**優先度**: 高（フェーズ2: 管理機能拡充）

---

## 1. 概要

### 1.1 目的
システム管理者（system_admin）が、システム内のすべての管理者アカウント（system_admin と auctioneer）を一覧表示し、各アカウントの状態を管理するための画面です。管理者アカウントの検索、フィルタリング、状態変更、編集が可能です。

### 1.2 対象ユーザー
- **system_admin（システム管理者）**: この画面にアクセスできる唯一のロール

### 1.3 主要機能
1. 管理者アカウントの一覧表示（ID、メールアドレス、表示名、ロール、状態、作成日）
2. 検索機能（メールアドレス）
3. フィルタリング機能（ロール別、状態別）
4. ソート機能（作成日順、メールアドレス順）
5. ページネーション（20件/ページ）
6. アカウント状態の変更（有効化・停止）
7. 管理者編集画面への遷移
8. 新規管理者登録画面への遷移

---

## 2. 画面レイアウト

### 2.1 画面構成

```
┌───────┬─────────────────────────────────────────────────────────────┐
│       │ [ロゴ] システム管理者一覧                    [ログアウト]    │
│       ├─────────────────────────────────────────────────────────────┤
│ サイド│                                                             │
│ メニュー │ システム管理者一覧                                           │
│       │                                                             │
│ ☰ メニュー│ ┌─────────────────────────────────────────────────────────┐ │
│       │ │ [+ 新規管理者登録]                 [検索: __________] 🔍 │ │
│ [ダッシュ]│ │                                                         │ │
│ ボード│ │ フィルタ:                                                │ │
│       │ │ ロール: [すべて▾] [system_admin] [auctioneer]            │ │
│ [オーク]│ │ 状態:   [すべて▾] [有効] [停止] [削除済み]                │ │
│ ション│ └─────────────────────────────────────────────────────────┘ │
│       │                                                             │
│ [入札者]│ ┌─────────────────────────────────────────────────────────┐ │
│       │ │ ID ▲ │ メールアドレス    │ 表示名  │ ロール  │ 状態 │ 作成日  │ アクション │ │
│ [管理者]│ ├─────────────────────────────────────────────────────────┤ │
│       │ │ 1    │ admin@example.com │ 管理者  │ system_admin│ 有効│2025/01/01│[編集][停止]│ │
│       │ │ 2    │ auctioneer@ex.com │ 主催者A │ auctioneer │ 有効│2025/01/02│[編集][停止]│ │
│       │ │ 3    │ staff@example.com │ スタッフ│ auctioneer │ 停止│2025/01/03│[編集][復活]│ │
│       │ │ ...  │ ...               │ ...     │ ...        │ ... │ ...      │ ...        │ │
│       │ └─────────────────────────────────────────────────────────┘ │
│       │                                                             │
│       │ 1-20件 / 全50件    [◀ 前へ] [1] [2] [3] [次へ ▶]              │
│       │                                                             │
└───────┴─────────────────────────────────────────────────────────────┘
```

### 2.2 デザイン要件

- **レイアウト**: 全幅のテーブルレイアウト、最大幅1400px
- **カード**: 白い背景、薄い影
- **テーブル**: 明確な行区切り、ホバー時に背景色がハイライト
- **ボタン**:
  - 新規登録ボタン: 青系（primary）、目立つ配置
  - 編集ボタン: 灰色系（secondary）
  - 停止ボタン: 赤系（destructive）
  - 復活ボタン: 緑系（success）
- **バッジ**:
  - ロール: `system_admin`（赤バッジ）、`auctioneer`（青バッジ）
  - 状態: `active`（緑バッジ）、`suspended`（黄バッジ）、`deleted`（灰バッジ）
- **検索フィールド**: 右上に配置、アイコン付き
- **フィルタ**: ドロップダウン形式、複数選択可能

---

## 3. 表示項目の仕様

### 3.1 テーブル列の定義

| 列名 | データ型 | 説明 | 表示形式 | ソート | 幅 |
|------|---------|------|---------|-------|-----|
| **ID** | BIGINT | 管理者ID | 数値 | ○ | 80px |
| **メールアドレス** | VARCHAR(255) | ログインに使用するメール | テキスト | ○ | 250px |
| **表示名** | VARCHAR(100) | 画面に表示される名前 | テキスト | × | 150px |
| **ロール** | VARCHAR(20) | system_admin または auctioneer | バッジ | × | 150px |
| **状態** | VARCHAR(20) | active / suspended / deleted | バッジ | × | 100px |
| **作成日** | TIMESTAMP | アカウント作成日時 | YYYY/MM/DD | ○ | 120px |
| **アクション** | - | 編集・状態変更ボタン | ボタン | × | 150px |

### 3.2 バッジの表示仕様

**ロールバッジ**:
- `system_admin`: 赤背景、白文字、「システム管理者」
- `auctioneer`: 青背景、白文字、「主催者」

**状態バッジ**:
- `active`: 緑背景、白文字、「有効」
- `suspended`: 黄背景、黒文字、「停止」
- `deleted`: 灰背景、白文字、「削除済み」

### 3.3 表示名の処理

- 表示名が設定されている場合: 表示名を表示
- 表示名が未設定（NULL）の場合: 「（未設定）」と表示

---

## 4. 検索・フィルタリング機能

### 4.1 検索機能

**検索対象**:
- メールアドレス（部分一致）

**検索動作**:
- 検索ボックスに入力後、Enterキー押下またはボタンクリックで検索実行
- 検索結果がない場合: 「該当する管理者が見つかりませんでした」と表示
- 検索クリアボタン（×）で検索条件をリセット

**検索仕様**:
- 大文字・小文字を区別しない（ILIKE検索）
- 前方一致、中間一致、後方一致すべて対象

### 4.2 ロール別フィルタ

| フィルタ値 | 表示内容 |
|-----------|---------|
| すべて | すべてのロールを表示（デフォルト） |
| system_admin | システム管理者のみ表示 |
| auctioneer | 主催者のみ表示 |

### 4.3 状態別フィルタ

| フィルタ値 | 表示内容 |
|-----------|---------|
| すべて | すべての状態を表示（デフォルト） |
| active | 有効なアカウントのみ表示 |
| suspended | 停止中のアカウントのみ表示 |
| deleted | 削除済みアカウントのみ表示 |

**デフォルト表示**:
- 初期表示では `active` と `suspended` のみ表示（削除済みは非表示）

### 4.4 複合フィルタ

- ロールフィルタと状態フィルタは組み合わせ可能
- 検索キーワードとフィルタも組み合わせ可能
- 例: 「system_adminロール」かつ「有効状態」かつ「メールに`admin`を含む」

---

## 5. ソート機能

### 5.1 ソート可能な列

| 列名 | ソート順 | デフォルト |
|------|---------|----------|
| ID | 昇順・降順 | 昇順（デフォルト） |
| メールアドレス | 昇順・降順 | - |
| 作成日 | 昇順・降順 | - |

### 5.2 ソート動作

- 列ヘッダーをクリックでソート実行
- 初回クリック: 昇順
- 2回目クリック: 降順
- 3回目クリック: ソート解除（デフォルトに戻る）
- ソート中の列にはアイコン表示（▲昇順、▼降順）

### 5.3 デフォルトソート

- ID昇順（作成日が古い順）

---

## 6. ページネーション

### 6.1 ページング仕様

- **表示件数**: 20件/ページ（固定）
- **ページ番号**: 最大5ページまで表示
- **総件数表示**: 「1-20件 / 全50件」の形式

### 6.2 ページネーションUI

```
[◀ 前へ] [1] [2] [3] [4] [5] [次へ ▶]
```

- 現在のページ番号はハイライト表示
- 最初のページでは「前へ」ボタンが無効
- 最後のページでは「次へ」ボタンが無効
- ページ番号をクリックで直接ジャンプ

---

## 7. アクション機能

### 7.1 編集ボタン

**動作**:
- クリックで管理者編集画面（1.2.3）へ遷移
- パス: `/admin/admins/:id/edit`

**表示条件**:
- すべてのアカウントで表示

### 7.2 状態変更ボタン

**停止ボタン**:
- 対象: `active`状態のアカウント
- クリックで確認モーダル表示
  - タイトル: 「アカウントを停止しますか?」
  - メッセージ: 「このアカウントはログインできなくなります。」
  - ボタン: [キャンセル] [停止する]
- 実行後、状態が`suspended`に変更
- 成功メッセージ: 「アカウントを停止しました」

**復活ボタン**:
- 対象: `suspended`状態のアカウント
- クリックで確認モーダル表示
  - タイトル: 「アカウントを復活しますか?」
  - メッセージ: 「このアカウントは再びログインできるようになります。」
  - ボタン: [キャンセル] [復活する]
- 実行後、状態が`active`に変更
- 成功メッセージ: 「アカウントを復活しました」

**削除済みアカウント**:
- `deleted`状態のアカウントには状態変更ボタンを表示しない
- 削除済みアカウントは編集画面でのみ復旧可能

---

## 8. 処理フロー

### 8.1 初期表示フロー

```
[ユーザー操作]
  ↓
1. `/admin/admins`にアクセス
  ↓
2. フロントエンドで認証チェック
   - JWTトークンの確認
   - ロールが`system_admin`であることを確認
  ↓
3. バックエンドAPIに一覧取得リクエスト送信
   - デフォルト: ページ1、20件、ID昇順
   - デフォルトフィルタ: status IN ('active', 'suspended')
  ↓
4. バックエンドでデータ取得
   - adminsテーブルから該当レコードを取得
   - 総件数をカウント
   - ページネーション処理
  ↓
5. フロントエンドで一覧表示
   - テーブルにデータをレンダリング
   - ページネーションUI表示
```

### 8.2 検索・フィルタ実行フロー

```
[ユーザー操作]
  ↓
1. 検索キーワード入力またはフィルタ選択
  ↓
2. Enterキー押下またはボタンクリック
  ↓
3. フロントエンドでクエリパラメータ作成
  ↓
4. バックエンドAPIにリクエスト送信
   - パラメータ: keyword, role, status, page, sort
  ↓
5. バックエンドでフィルタ処理
   - WHERE句に条件追加
   - LIKE検索、IN検索
  ↓
6. フロントエンドで結果表示
   - ページ番号を1にリセット
   - 該当件数表示
```

### 8.3 状態変更フロー

```
[ユーザー操作]
  ↓
1. 停止ボタンまたは復活ボタンをクリック
  ↓
2. 確認モーダル表示
  ↓
3. ユーザーが確認ボタンをクリック
  ↓
4. バックエンドAPIに状態変更リクエスト送信
   - PATCH /api/admins/:id/status
   - Body: {"status": "suspended"} または {"status": "active"}
  ↓
5. バックエンドでデータ更新
   - adminsテーブルのstatusカラムを更新
   - updated_atを現在時刻に更新
  ↓
6. フロントエンドで成功メッセージ表示
  ↓
7. 一覧を再読み込み（最新状態を反映）
```

---

## 9. セキュリティ要件

### 9.1 権限チェック

1. **フロントエンド**:
   - Vue Routerのナビゲーションガードで`system_admin`ロールを確認
   - ロールが異なる場合は403エラーページへリダイレクト

2. **バックエンド**:
   - すべてのエンドポイントでJWT認証ミドルウェアを適用
   - ロール検証ミドルウェアで`system_admin`を要求
   - 権限不足の場合は403エラーを返却

### 9.2 データ保護

1. **パスワードハッシュの非表示**:
   - APIレスポンスに`password_hash`を含めない
   - Repositoryレイヤーで除外

2. **削除済みアカウントの扱い**:
   - デフォルトでは非表示
   - 明示的にフィルタ選択時のみ表示

### 9.3 CSRFとXSS対策

- JWTトークンを使用（Cookieベースではない）
- ユーザー入力は自動エスケープ（Vueの機能）
- APIからのレスポンスもエスケープ処理

---

## 10. データベース設計

### 10.1 使用テーブル

**adminsテーブル**（既存、マイグレーション001で作成済み）:

| カラム名 | データ型 | 説明 | 制約 |
|---------|---------|------|------|
| id | BIGSERIAL | 管理者ID | 主キー |
| email | VARCHAR(255) | メールアドレス | 必須、ユニーク |
| password_hash | VARCHAR(255) | パスワードハッシュ | 必須 |
| display_name | VARCHAR(100) | 表示名 | 任意 |
| role | VARCHAR(20) | ロール | 必須、CHECK制約 |
| status | VARCHAR(20) | 状態 | 必須、CHECK制約 |
| created_at | TIMESTAMP | 作成日時 | 自動設定 |
| updated_at | TIMESTAMP | 更新日時 | 自動更新 |

### 10.2 インデックス（既存）

- `admins_email_idx`: emailカラムにユニークインデックス
- `admins_role_idx`: roleカラムにBTreeインデックス（検索高速化）
- `admins_status_idx`: statusカラムにBTreeインデックス（フィルタ高速化）

### 10.3 クエリ最適化

**一覧取得クエリ例**:
```sql
SELECT id, email, display_name, role, status, created_at
FROM admins
WHERE status IN ('active', 'suspended')
  AND (email ILIKE '%keyword%' OR 'keyword' IS NULL)
  AND (role = 'system_admin' OR 'system_admin' IS NULL)
ORDER BY id ASC
LIMIT 20 OFFSET 0;
```

**総件数取得クエリ例**:
```sql
SELECT COUNT(*) FROM admins
WHERE status IN ('active', 'suspended')
  AND (email ILIKE '%keyword%' OR 'keyword' IS NULL)
  AND (role = 'system_admin' OR 'system_admin' IS NULL);
```

---

## 11. API仕様

### 11.1 一覧取得API

**エンドポイント**: `GET /api/admins`

**クエリパラメータ**:

| パラメータ | 型 | 必須 | 説明 | 例 |
|-----------|---|------|------|-----|
| page | integer | × | ページ番号（デフォルト: 1） | 1 |
| limit | integer | × | 1ページあたりの件数（デフォルト: 20、最大: 100） | 20 |
| keyword | string | × | メールアドレス検索キーワード | admin |
| role | string | × | ロールフィルタ（system_admin / auctioneer） | system_admin |
| status | string | × | 状態フィルタ（active / suspended / deleted、カンマ区切りで複数指定可能） | active,suspended |
| sort | string | × | ソート順（id_asc / id_desc / email_asc / email_desc / created_at_asc / created_at_desc）（デフォルト: id_asc） | created_at_desc |

**リクエスト例**:
```
GET /api/admins?page=1&limit=20&keyword=admin&role=system_admin&status=active,suspended&sort=id_asc
Authorization: Bearer {JWT_TOKEN}
```

**レスポンス形式（成功時）**:
```json
{
  "admins": [
    {
      "id": 1,
      "email": "admin@example.com",
      "display_name": "システム管理者",
      "role": "system_admin",
      "status": "active",
      "created_at": "2025-01-01T00:00:00Z"
    },
    {
      "id": 2,
      "email": "auctioneer@example.com",
      "display_name": "主催者A",
      "role": "auctioneer",
      "status": "active",
      "created_at": "2025-01-02T00:00:00Z"
    }
  ],
  "pagination": {
    "total": 50,
    "page": 1,
    "limit": 20,
    "total_pages": 3
  }
}
```

**レスポンス形式（失敗時）**:
```json
{
  "error": "Unauthorized"
}
```

### 11.2 状態変更API

**エンドポイント**: `PATCH /api/admins/:id/status`

**リクエスト形式**:
```
PATCH /api/admins/1/status
Authorization: Bearer {JWT_TOKEN}
Content-Type: application/json

{
  "status": "suspended"
}
```

**レスポンス形式（成功時）**:
```json
{
  "id": 1,
  "email": "admin@example.com",
  "display_name": "システム管理者",
  "role": "system_admin",
  "status": "suspended",
  "updated_at": "2025-01-10T12:00:00Z"
}
```

**レスポンス形式（失敗時）**:
```json
{
  "error": "Invalid status value"
}
```

### 11.3 エラーレスポンス一覧

| HTTPステータス | エラーメッセージ | 発生条件 |
|--------------|----------------|---------|
| 400 Bad Request | Invalid query parameters | クエリパラメータが不正 |
| 401 Unauthorized | Unauthorized | JWT認証失敗 |
| 403 Forbidden | Insufficient permissions | ロールが`system_admin`でない |
| 404 Not Found | Admin not found | 指定IDの管理者が存在しない |
| 500 Internal Server Error | Internal server error | サーバー内部エラー |

---

## 12. バックエンド実装要件

### 12.1 レイヤー構成

**Domain層（データモデル）**:
- Admin構造体（既存）
- AdminListRequest構造体（リクエストパラメータ）
- AdminListResponse構造体（レスポンス）
- Pagination構造体（ページネーション情報）

**Repository層（データアクセス）**:
- `FindAdminsWithFilters()`: フィルタ付き一覧取得
- `CountAdminsWithFilters()`: フィルタ付き総件数取得
- `UpdateAdminStatus()`: 状態更新

**Service層（ビジネスロジック）**:
- `GetAdminList()`: 一覧取得処理
- `UpdateAdminStatus()`: 状態変更処理
- バリデーション（ロール、ステータスの値チェック）

**Handler層（APIエンドポイント）**:
- `GetAdminListHandler`: 一覧取得エンドポイント
- `UpdateAdminStatusHandler`: 状態変更エンドポイント
- クエリパラメータのパース
- レスポンスの生成

### 12.2 ミドルウェア

- JWT認証ミドルウェア（既存）
- ロール検証ミドルウェア（`system_admin`のみ許可）

### 12.3 使用技術

- **フレームワーク**: Gin
- **ORM**: GORM
- **バリデーション**: go-playground/validator

---

## 13. フロントエンド実装要件

### 13.1 ディレクトリ構成

```
frontend/src/
  views/
    admin/
      AdminListView.vue          # 一覧画面コンポーネント
  components/
    admin/
      AdminTable.vue             # テーブルコンポーネント
      AdminTableRow.vue          # テーブル行コンポーネント
      AdminFilters.vue           # フィルタコンポーネント
      AdminSearchBar.vue         # 検索バーコンポーネント
      AdminStatusBadge.vue       # 状態バッジコンポーネント
      AdminRoleBadge.vue         # ロールバッジコンポーネント
      AdminStatusChangeDialog.vue # 状態変更確認モーダル
    ui/
      table.vue                  # テーブルUIコンポーネント
      pagination.vue             # ページネーションコンポーネント
      select.vue                 # セレクトボックス
      input.vue                  # 入力フィールド
      button.vue                 # ボタン
      badge.vue                  # バッジ
      dialog.vue                 # モーダルダイアログ
  services/
    api/
      adminApi.ts                # 管理者API呼び出し
  stores/
    adminStore.ts                # 管理者状態管理
  router/
    index.ts                     # ルーティング設定
```

### 13.2 実装コンポーネント

1. **一覧画面（AdminListView.vue）**:
   - ページ全体のレイアウト
   - 検索バー、フィルタ、テーブル、ページネーションの配置
   - データ取得処理
   - URLクエリパラメータの管理

2. **テーブルコンポーネント（AdminTable.vue）**:
   - 管理者一覧の表示
   - ソート機能
   - ヘッダー定義

3. **テーブル行コンポーネント（AdminTableRow.vue）**:
   - 各管理者の情報表示
   - アクションボタン（編集、停止、復活）
   - バッジ表示

4. **フィルタコンポーネント（AdminFilters.vue）**:
   - ロールフィルタ
   - 状態フィルタ
   - フィルタ変更時のイベント発火

5. **検索バーコンポーネント（AdminSearchBar.vue）**:
   - メールアドレス検索入力
   - 検索実行
   - 検索クリア

6. **状態変更確認モーダル（AdminStatusChangeDialog.vue）**:
   - 停止/復活の確認メッセージ
   - 実行・キャンセルボタン
   - API呼び出し

7. **管理者API Client（adminApi.ts）**:
   - `getAdminList()`: 一覧取得
   - `updateAdminStatus()`: 状態変更
   - エラーハンドリング

8. **管理者状態管理（adminStore.ts）**:
   - 一覧データの保持
   - フィルタ・検索条件の保持
   - ページネーション状態の保持
   - 一覧取得処理
   - 状態変更処理
   - エラーメッセージの管理

9. **ルーティング設定（router/index.ts）**:
   - `/admin/admins`へのルート定義
   - 認証ガード（`system_admin`のみ）

### 13.3 使用技術

- **フレームワーク**: Vue 3（Composition API）
- **UIライブラリ**: Shadcn Vue + Tailwind CSS
- **状態管理**: Pinia
- **HTTP Client**: Axios
- **ルーティング**: Vue Router

---

## 14. 画面遷移

### 14.1 遷移パターン

```
/admin/dashboard（ダッシュボード）
  ↓
  [管理者一覧]クリック
  ↓
/admin/admins（管理者一覧）
  ↓
  ├─ [新規管理者登録]クリック
  │    ↓
  │  /admin/admins/new（管理者登録）
  │
  └─ [編集]ボタンクリック
       ↓
     /admin/admins/:id/edit（管理者編集）
```

### 14.2 認証ガードの動作

1. **未認証ユーザーがアクセスした場合**:
   - `/admin/login`へ自動リダイレクト

2. **auctioneeerロールがアクセスした場合**:
   - 403エラーページを表示
   - メッセージ: 「この画面へのアクセス権限がありません」

3. **system_adminロールの場合**:
   - 正常に一覧画面を表示

---

## 15. UIの動作仕様

### 15.1 通常時の動作

1. **初期表示**:
   - デフォルトフィルタ: 有効・停止中のアカウント
   - ソート: ID昇順
   - ページ: 1ページ目

2. **ホバー時**:
   - テーブル行の背景色が薄いグレーに変化
   - 編集・状態変更ボタンの色が濃くなる

3. **検索実行時**:
   - ページ番号を1にリセット
   - 検索キーワードをハイライト表示（オプション）

4. **フィルタ変更時**:
   - ページ番号を1にリセット
   - 該当件数を再計算

5. **ページ遷移時**:
   - スムーズにスクロール（ページトップへ）
   - ローディング表示（スピナー）

### 15.2 状態変更時の動作

1. **停止ボタンクリック時**:
   - 確認モーダルが表示される
   - モーダルの外側をクリック、またはEscキーでキャンセル

2. **API通信中**:
   - ボタンが無効化される
   - ボタンにスピナーアイコン表示

3. **成功時**:
   - モーダルを閉じる
   - 成功メッセージをトースト通知で表示（3秒間）
   - 一覧を自動再読み込み

4. **失敗時**:
   - エラーメッセージをモーダル内に表示
   - ボタンを再度有効化

---

## 16. レスポンシブデザイン

### 16.1 スマートフォン（767px以下）

- テーブルをカード形式に変更
- 各管理者情報をカードで表示
- フィルタはドロワー（引き出し）形式で表示
- ページネーションは簡略版（前へ・次へのみ）

**カードレイアウト例**:
```
┌─────────────────────────────────┐
│ admin@example.com               │
│ システム管理者                    │
│ ロール: [システム管理者]          │
│ 状態: [有効]                     │
│ 作成日: 2025/01/01               │
│ [編集] [停止]                    │
└─────────────────────────────────┘
```

### 16.2 タブレット（768px - 1279px）

- テーブル形式を維持
- 列幅を調整（一部列を非表示にするオプション）
- フィルタは折りたたみ可能

### 16.3 PC（1280px以上）

- フルテーブル表示
- すべての列を表示
- フィルタは常に表示

---

## 17. アクセシビリティ

### 17.1 キーボード操作

- Tabキー: ボタン・フィールド間の移動
- Enterキー: ボタンのクリック、検索実行
- Escapeキー: モーダルを閉じる
- 矢印キー: テーブル行間の移動（オプション）

### 17.2 スクリーンリーダー対応

- テーブルに`<caption>`を設定
- ヘッダーに`scope`属性を設定
- アクションボタンに`aria-label`を設定
  - 例: `aria-label="admin@example.comのアカウントを編集"`
- モーダルに`role="dialog"`、`aria-modal="true"`を設定

### 17.3 フォーカス表示

- キーボードフォーカスを明確に表示（青い枠線）
- スキップリンク（ナビゲーションをスキップしてメインコンテンツへ）

---

## 18. テスト要件

### 18.1 バックエンドテスト

**正常系テスト**:
- デフォルトパラメータで一覧取得成功
- フィルタ適用で正しい結果が返却される
- ページネーションが正しく機能する
- ソートが正しく機能する
- 状態変更が正しく実行される

**異常系テスト**:
- 認証なしでアクセス（401エラー）
- auctioneeerロールでアクセス（403エラー）
- 存在しない管理者IDで状態変更（404エラー）
- 不正なステータス値で状態変更（400エラー）
- 不正なクエリパラメータ（400エラー）

### 18.2 フロントエンドテスト

**コンポーネントテスト**:
- AdminListViewが正しくレンダリングされる
- フィルタ変更時に正しいAPIリクエストが送信される
- 検索実行時にURLクエリパラメータが更新される
- 状態変更モーダルが正しく表示される

**統合テスト**:
- 一覧取得成功時にデータが表示される
- 状態変更成功時に一覧が更新される
- エラー時にエラーメッセージが表示される

---

## 19. 環境変数

バックエンド・フロントエンドともに既存の環境変数を使用（`admin_login_implementation_plan.md`参照）。

---

## 20. 実装手順

### Phase 1: バックエンドAPI（3-4時間）
- [x] Domain層にAdminListRequest、AdminListResponse、Pagination構造体を定義
- [x] Repository層にフィルタ付き一覧取得、総件数取得、状態更新メソッドを実装
- [x] Service層に一覧取得、状態変更ロジックを実装
- [x] Handler層に一覧取得、状態変更エンドポイントを実装
- [x] ルーティング設定とミドルウェア適用
- [ ] 手動テスト（curlまたはPostman）

### Phase 2: フロントエンド基盤（2-3時間）
- [x] adminApi.tsにgetAdminList、updateAdminStatusを実装
- [x] adminStore.tsに状態管理を実装
- [x] ルーティング設定（/admin/admins）と認証ガード

### Phase 3: フロントエンドUI（4-5時間）
- [x] AdminListView.vueの実装
- [x] AdminTable.vueの実装
- [x] AdminFilters.vueの実装
- [x] AdminSearchBar.vueの実装
- [x] AdminStatusBadge.vue、AdminRoleBadge.vueの実装
- [x] AdminStatusChangeDialog.vueの実装
- [x] ページネーションUIの実装

### Phase 4: テストと検証（2-3時間）
- [x] バックエンドユニットテストの作成
- [x] フロントエンドコンポーネントテストの作成
- [ ] 統合テストの実施
- [ ] レスポンシブデザインの検証

**合計想定時間**: 11-15時間

---

## 21. 成功基準

以下の条件がすべて満たされたら実装完了とします:

- [ ] 管理者一覧が正しく表示される
- [ ] 検索機能が正しく動作する
- [ ] ロール・状態フィルタが正しく動作する
- [ ] ソート機能が正しく動作する
- [ ] ページネーションが正しく動作する
- [ ] アカウント停止・復活が正しく動作する
- [ ] 編集ボタンから編集画面へ遷移できる
- [ ] system_adminロールのみアクセス可能
- [ ] レスポンシブデザインが正しく動作する
- [ ] すべてのテストが通過する

---

## 22. 次のステップ

この実装完了後、以下の機能を実装予定:

1. **管理者登録画面（1.2.2）**:
   - 新規管理者アカウントの作成

2. **管理者編集画面（1.2.3）**:
   - 既存管理者アカウントの編集
   - パスワード変更
   - ロール変更

3. **入札者一覧画面（1.2.4）**:
   - 入札者アカウントの一覧表示
   - ポイント管理機能

---

## 23. 参考資料

### 23.1 関連ドキュメント

- [画面一覧](../screen_list.md): すべての画面の概要
- [データベース定義](../database_definition.md): テーブル構造の詳細
- [管理者ログイン実装プラン](admin_login_implementation_plan.md): 認証処理の参考

---

**作成者**: Claude Code
**レビュー状態**: 未レビュー
**最終更新**: 2025年11月21日
